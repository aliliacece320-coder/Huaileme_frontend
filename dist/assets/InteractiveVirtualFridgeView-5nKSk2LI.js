import{o as D,c as r,a as t,e as b,f as p,l as j,t as n,F as m,r as g,g as v,i as I,h as f,u as M,j as i,n as c,d as C,s as T,x as $,m as B}from"./index-TxYDMVzU.js";import{s as N}from"./request-8HA-zsBu.js";import{a as A,g as R}from"./foods-lDgA2Xnc.js";import{_ as U}from"./NavBar-AT4074vg.js";const E={class:"min-h-screen min-h-[100dvh] flex flex-col bg-[#fffcf9] text-slate-800"},Z={class:"sticky top-0 z-50 safe-top bg-[#fffcf9]/90 backdrop-blur-md px-5 py-4 flex items-center justify-between"},q={class:"flex items-center gap-1"},G={class:"flex-1 flex flex-col px-5 pb-32"},H={class:"mt-4 text-center"},J={class:"mt-2 text-4xl font-black text-slate-800"},K={class:"mt-6 flex justify-around bg-white/60 border border-orange-100/50 p-5 rounded-3xl shadow-sm"},O={class:"flex flex-col items-center"},Q={class:"text-xl font-bold text-slate-800"},W={class:"flex flex-col items-center"},X={class:"text-xl font-bold text-[#f43f5e]"},Y={class:"flex flex-col items-center"},tt={class:"text-xl font-bold text-[#10b981]"},et={class:"flex py-6"},st={class:"flex h-12 flex-1 items-center justify-center rounded-2xl bg-slate-100/80 p-1.5 gap-1"},lt={class:"truncate"},at=["value"],ot={class:"flex-1 relative min-h-[40vh] rounded-[3rem] bg-white border-[10px] border-slate-50 shadow-2xl shadow-slate-200/50 overflow-hidden"},nt={class:"absolute top-3 left-6 text-[11px] text-slate-300 font-bold tracking-wider"},rt={class:"flex gap-6 z-10 mb-2 flex-wrap"},it=["onClick"],dt={class:"mt-10"},ut={class:"flex items-center justify-between mb-4 px-1"},ft={class:"grid grid-cols-2 gap-4"},ct={class:"text-slate-800 text-sm font-bold leading-tight"},ht={__name:"InteractiveVirtualFridgeView",setup(xt){const S=M(),d=v("Cooling"),x=v([]),h=v({}),y=[{value:"Cooling",label:"保鲜层"},{value:"Freezing",label:"冷冻室"},{value:"Pantry",label:"小零食区"}],_=f(()=>x.value.length),w=f(()=>x.value.filter(s=>(s.days_left??s.daysLeft??0)<=3).length),F=f(()=>{var s;return((s=h.value)==null?void 0:s.consumedThisMonth)??0}),L=f(()=>{const s=_.value,e=w.value;return s?Math.round((s-e)/s*100):85});function k(s){const e=x.value;return s==="Cooling"?e.filter(a=>a.storage_location==="冷藏室"||a.storageStatus==="fridge"):s==="Freezing"?e.filter(a=>a.storage_location==="冷冻室"||a.storageStatus==="freezer"):e.filter(a=>a.storage_location==="储藏柜"||a.storageStatus==="room")}const V=f(()=>k(d.value).slice(0,2));function P(s){return{肉类:"restaurant",蔬菜:"nutrition",水果:"eco",奶制品:"local_drink",蛋白质:"egg",豆制品:"inventory_2"}[s]||"lunch_dining"}function u(s){const e=s.days_left??s.daysLeft??0;return e<0?{bg:"bg-[#fff1f2]",border:"border-[#f43f5e]/10",text:"text-[#f43f5e]",badge:"bg-[#f43f5e]",label:"已过期"}:e<=1?{bg:"bg-[#fff1f2]",border:"border-[#f43f5e]/10",text:"text-[#f43f5e]",badge:"bg-[#f43f5e]",label:"剩1天啦"}:e<=3?{bg:"bg-[#fffbeb]",border:"border-[#f59e0b]/10",text:"text-[#f59e0b]",badge:"bg-[#f59e0b]",label:"3天内"}:{bg:"bg-[#ecfdf5]",border:"border-[#10b981]/10",text:"text-[#10b981]",badge:"bg-[#10b981]",label:`还剩${e}天`}}function z(s){S.push({name:"ItemDetail",params:{id:String(s)}})}return D(async()=>{try{const[s,e]=await Promise.all([A({status:"active"}),R().catch(()=>({}))]);x.value=Array.isArray(s==null?void 0:s.items)?s.items:[],h.value=e}catch{N("加载失败","error")}}),(s,e)=>{const a=I("router-link");return i(),r("div",E,[t("header",Z,[e[3]||(e[3]=t("div",{class:"flex items-center gap-2"},[t("div",{class:"bg-[#10b981]/10 p-2 rounded-xl"},[t("span",{class:"material-symbols-outlined text-[#10b981] text-2xl"},"kitchen")]),t("h1",{class:"text-xl font-black tracking-tight text-slate-800"},"坏了么")],-1)),t("div",q,[b(a,{to:"/stats",class:"p-2.5 rounded-full hover:bg-orange-50 text-slate-400 transition-colors flex items-center justify-center"},{default:p(()=>[...e[1]||(e[1]=[t("span",{class:"material-symbols-outlined"},"history",-1)])]),_:1}),b(a,{to:"/family",class:"p-2.5 rounded-full hover:bg-orange-50 text-slate-400 transition-colors flex items-center justify-center"},{default:p(()=>[...e[2]||(e[2]=[t("span",{class:"material-symbols-outlined"},"settings",-1)])]),_:1})])]),t("main",G,[t("div",H,[e[10]||(e[10]=t("h2",{class:"text-slate-800 text-xl font-bold mb-1"},"我的虚拟小冰箱",-1)),e[11]||(e[11]=t("h4",{class:"text-[#94a3b8] text-[11px] font-bold leading-normal tracking-widest uppercase"},"冰箱保鲜指数",-1)),t("div",J,[j(n(L.value),1),e[4]||(e[4]=t("span",{class:"text-[#10b981] text-2xl ml-0.5"},"%",-1))]),t("div",K,[t("div",O,[t("span",Q,n(_.value),1),e[5]||(e[5]=t("span",{class:"text-[11px] text-[#94a3b8] font-medium mt-1"},"库存宝贝",-1))]),e[8]||(e[8]=t("div",{class:"w-px h-8 bg-slate-100 self-center"},null,-1)),t("div",W,[t("span",X,n(w.value),1),e[6]||(e[6]=t("span",{class:"text-[11px] text-[#94a3b8] font-medium mt-1"},"赶快吃完",-1))]),e[9]||(e[9]=t("div",{class:"w-px h-8 bg-slate-100 self-center"},null,-1)),t("div",Y,[t("span",tt,n(F.value),1),e[7]||(e[7]=t("span",{class:"text-[11px] text-[#94a3b8] font-medium mt-1"},"光盘行动",-1))])])]),t("div",et,[t("div",st,[(i(),r(m,null,g(y,l=>t("label",{key:l.value,class:c(["flex cursor-pointer h-full grow items-center justify-center overflow-hidden rounded-xl px-2 text-sm font-bold transition-all",d.value===l.value?"bg-white text-[#10b981] shadow-sm":"text-slate-500"])},[t("span",lt,n(l.label),1),C(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>d.value=o),type:"radio",value:l.value,class:"sr-only",name:"zone"},null,8,at),[[T,d.value]])],2)),64))])]),t("div",ot,[e[12]||(e[12]=t("div",{class:"absolute inset-0 bg-gradient-to-b from-blue-50/20 to-transparent opacity-40"},null,-1)),(i(),r(m,null,g(y,l=>C(t("div",{key:l.value,class:"relative w-full h-full flex flex-col justify-end pb-5 px-6"},[t("div",nt,n(l.label),1),t("div",rt,[(i(!0),r(m,null,g(k(l.value),o=>(i(),r("div",{key:o.id,class:"group/item relative cursor-pointer",onClick:bt=>z(o.id)},[t("div",{class:c(["w-16 h-16 rounded-full flex items-center justify-center border transform active:scale-90 transition-transform",u(o).bg,u(o).border])},[t("span",{class:c(["material-symbols-outlined text-3xl",u(o).text])},n(P(o.category)),3)],2),t("span",{class:c(["absolute -top-1 -right-1 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-lg",u(o).badge])},n(u(o).label),3)],8,it))),128))])]),[[$,d.value===l.value]])),64))]),t("div",dt,[t("div",ut,[e[14]||(e[14]=t("h3",{class:"text-slate-800 text-lg font-bold"},"新鲜速览",-1)),b(a,{to:"/",class:"text-[#10b981] text-sm font-bold"},{default:p(()=>[...e[13]||(e[13]=[j("去看看全部",-1)])]),_:1})]),t("div",ft,[(i(!0),r(m,null,g(V.value,(l,o)=>(i(),r("div",{key:l.id||o,class:"group relative bg-white flex flex-col gap-3 rounded-[1.75rem] justify-end p-4 aspect-[4/3] border border-slate-100 shadow-sm overflow-hidden",style:B({backgroundImage:`linear-gradient(0deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.2) 60%), url('${l.image_url||l.imageUrl||"https://via.placeholder.com/200"}')`,backgroundSize:"cover",backgroundPosition:"center"})},[t("div",null,[t("p",ct,n(l.name),1),t("p",{class:c([(l.days_left??l.daysLeft)<=1?"text-[#f43f5e]":"text-[#10b981]","text-[10px] font-bold"])},n((l.days_left??l.daysLeft)<=1?"快喝掉吧":"非常新鲜")+" · 剩"+n(l.days_left??l.daysLeft??0)+"天 ",3)])],4))),128))])])]),b(U)])}}};export{ht as default};
